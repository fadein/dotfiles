#!/bin/sh

if [ -f ~/.Xdefaults ]; then
    xrdb -quiet -load < ~/.Xdefaults &
fi

# After copying new fonts into this directory, run `mkfontdir` and `mkfontscale` there
if [ -d $HOME/.fonts ]; then
    xset fp+ $HOME/.fonts
    xset fp rehash
fi

setxkbmap colehack,us -option grp:ctrls_toggle -option grp_led:scroll &

case $HOSTNAME in
    mariner*|voyager2*)
        xset s on +dpms
        export BROWSER=firefox
        ;;

    endeavour*|columbia*)
        # "Screensaver? We don't need no stinkin' screensaver!"
        xset s off -dpms
        export BROWSER=firefox

        # Make Zoom scale on HiDPI displays
        QT_AUTO_SCREEN_SCALE_FACTOR=2
        export QT_AUTO_SCREEN_SCALE_FACTOR

        synclient TouchpadOff=1 ClickPad=0
        ;;

    *)
        # "Screensaver? We don't need no stinkin' screensaver!"
        xset s off -dpms
        export BROWSER=firefox
        ;;
esac

case $1 in
	dwm)
		# set the variable USE_COMPTON to non-null to use compton
		case ${USE_COMPTON=no} in
			no)
				if ! pgrep -u $USER picom; then
					picom &
				fi
				;;
			*)
				if ! pgrep -u $USER compton; then
					compton -b
				fi
				;;
		esac

		if ! pgrep -u $USER dwm-statusbar; then
            dwm-statusbar &
        fi

        if [ -x ~/.wallpapers/cycle/next-wallpaper.sh ]; then
            ~/.wallpapers/cycle/next-wallpaper.sh &
        fi

        # Make Java apps work in DWM
        _JAVA_AWT_WM_NONREPARENTING=1
        export _JAVA_AWT_WM_NONREPARENTING
		;;
esac
